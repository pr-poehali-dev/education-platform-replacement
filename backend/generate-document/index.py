import json
import os
from typing import Dict, Any

def handler(event: Dict[str, Any], context: Any) -> Dict[str, Any]:
    """
    Генерирует документы по охране труда используя встроенные шаблоны
    Args: event с httpMethod, body (type, title, category, prompt)
    Returns: HTTP response с сгенерированным документом
    """
    method: str = event.get('httpMethod', 'GET')
    
    if method == 'OPTIONS':
        return {
            'statusCode': 200,
            'headers': {
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Methods': 'POST, OPTIONS',
                'Access-Control-Allow-Headers': 'Content-Type',
                'Access-Control-Max-Age': '86400'
            },
            'body': '',
            'isBase64Encoded': False
        }
    
    if method != 'POST':
        return {
            'statusCode': 405,
            'headers': {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            'body': json.dumps({'error': 'Method not allowed'}),
            'isBase64Encoded': False
        }
    
    body_data = json.loads(event.get('body', '{}'))
    doc_type = body_data.get('type', '')
    title = body_data.get('title', '')
    category = body_data.get('category', '')
    prompt = body_data.get('prompt', '')
    
    if not all([doc_type, title, prompt]):
        return {
            'statusCode': 400,
            'headers': {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            'body': json.dumps({'error': 'Missing required fields'}),
            'isBase64Encoded': False
        }
    
    # Генерация документа на основе типа
    content = generate_document_content(doc_type, title, category, prompt)
    
    return {
        'statusCode': 200,
        'headers': {
            'Content-Type': 'application/json',
            'Access-Control-Allow-Origin': '*'
        },
        'body': json.dumps({'content': content}),
        'isBase64Encoded': False
    }


def generate_document_content(doc_type: str, title: str, category: str, prompt: str) -> str:
    """Генерирует содержимое документа на основе типа и описания"""
    
    if doc_type == 'program':
        return generate_training_program(title, category, prompt)
    elif doc_type == 'iot':
        return generate_iot_instruction(title, category, prompt)
    elif doc_type == 'di':
        return generate_job_instruction(title, category, prompt)
    elif doc_type == 'profession':
        return generate_profession_instruction(title, category, prompt)
    elif doc_type == 'tool':
        return generate_tool_instruction(title, category, prompt)
    elif doc_type == 'electro':
        return generate_electro_instruction(title, category, prompt)
    else:
        return generate_generic_document(title, category, prompt)


def generate_training_program(title: str, category: str, prompt: str) -> str:
    """Генерирует программу обучения"""
    return f"""# {title}

## Категория: {category}

### 1. ОБЩИЕ ПОЛОЖЕНИЯ

1.1. Настоящая программа обучения разработана в соответствии с:
- Трудовым кодексом Российской Федерации
- Постановлением Правительства РФ от 24.12.2021 № 2464
- Приказом Минтруда России от 29.10.2021 № 774н
- Правилами по охране труда при работе на высоте (Приказ Минтруда России от 16.11.2020 № 782н)

1.2. Цель программы: обеспечение безопасных условий труда и формирование необходимых компетенций работников.

1.3. Требования: {prompt}

### 2. КАТЕГОРИЯ СЛУШАТЕЛЕЙ

2.1. К обучению допускаются работники, достигшие 18 лет, имеющие соответствующую квалификацию.

2.2. Обучение проводится для работников, выполняющих работы в сфере "{category}".

### 3. ПРОДОЛЖИТЕЛЬНОСТЬ И ФОРМА ОБУЧЕНИЯ

3.1. Общая продолжительность обучения: 40 академических часов
3.2. Форма обучения: очная / очно-заочная / дистанционная
3.3. Режим занятий: 8 академических часов в день

### 4. УЧЕБНО-ТЕМАТИЧЕСКИЙ ПЛАН

| № | Наименование темы | Часы |
|---|-------------------|------|
| 1 | Основы охраны труда и техники безопасности | 8 |
| 2 | Законодательство в области охраны труда | 6 |
| 3 | Производственная безопасность | 10 |
| 4 | Специальные требования безопасности | 12 |
| 5 | Практические занятия | 3 |
| 6 | Итоговая аттестация | 1 |
| **Итого:** | | **40** |

### 5. СОДЕРЖАНИЕ ПРОГРАММЫ

#### Тема 1. Основы охраны труда и техники безопасности (8 часов)
- Понятие охраны труда
- Основные принципы обеспечения безопасности
- Права и обязанности работников и работодателей
- Ответственность за нарушение требований охраны труда

#### Тема 2. Законодательство в области охраны труда (6 часов)
- Трудовой кодекс РФ
- Нормативные правовые акты по охране труда
- Государственный надзор и контроль за соблюдением требований охраны труда
- Профессиональные стандарты

#### Тема 3. Производственная безопасность (10 часов)
- Идентификация опасностей и оценка рисков
- Средства индивидуальной и коллективной защиты
- Организация безопасного производства работ
- Требования к рабочим местам

#### Тема 4. Специальные требования безопасности (12 часов)
{prompt}

Специфические требования для данной категории работников:
- Допуск к работам
- Порядок выполнения операций
- Требования к инструменту и оборудованию
- Действия в нештатных ситуациях

#### Тема 5. Практические занятия (3 часа)
- Отработка безопасных приемов выполнения работ
- Применение средств защиты
- Действия при возникновении аварийных ситуаций
- Оказание первой помощи

#### Тема 6. Итоговая аттестация (1 час)
- Проверка знаний в форме тестирования
- Практическая проверка навыков
- Оформление протокола и выдача удостоверения

### 6. ОРГАНИЗАЦИОННО-ПЕДАГОГИЧЕСКИЕ УСЛОВИЯ

6.1. **Требования к квалификации преподавателей:**
- Высшее или среднее профессиональное образование
- Опыт работы в области охраны труда не менее 3 лет
- Повышение квалификации не реже 1 раза в 3 года

6.2. **Материально-техническое обеспечение:**
- Учебный класс с посадочными местами
- Проектор и экран для презентаций
- Образцы СИЗ и оборудования
- Методические материалы

6.3. **Учебно-методическое обеспечение:**
- Учебники и пособия по охране труда
- Нормативные документы
- Инструкции по охране труда
- Презентации и видеоматериалы

### 7. ОЦЕНКА РЕЗУЛЬТАТОВ ОБУЧЕНИЯ

7.1. Текущий контроль проводится в форме устного опроса.

7.2. Итоговая аттестация проводится в форме экзамена (тестирование + практика).

7.3. Критерии оценки:
- "Отлично" - 90-100% правильных ответов
- "Хорошо" - 75-89% правильных ответов
- "Удовлетворительно" - 60-74% правильных ответов
- "Неудовлетворительно" - менее 60% правильных ответов

7.4. По результатам обучения выдается удостоверение о проверке знаний требований охраны труда.

### 8. ПЕРИОДИЧНОСТЬ ОБУЧЕНИЯ

8.1. Первичное обучение проводится при приеме на работу в течение месяца.

8.2. Периодическое обучение проводится не реже 1 раза в 3 года.

8.3. Внеочередная проверка знаний проводится:
- При изменении законодательства
- При вводе в эксплуатацию нового оборудования
- После несчастных случаев
- По требованию контролирующих органов

---

**Программа разработана:** {category}  
**Дата:** {get_current_date()}  
**Утверждена:** Приказом руководителя организации

*Документ создан системой ГорТех Аттестация*
"""


def generate_iot_instruction(title: str, category: str, prompt: str) -> str:
    """Генерирует инструкцию по охране труда"""
    return f"""# {title}

## Категория: {category}

---

## 1. ОБЩИЕ ТРЕБОВАНИЯ ОХРАНЫ ТРУДА

1.1. К самостоятельной работе допускаются лица:
- достигшие 18 лет;
- прошедшие обязательный предварительный медицинский осмотр;
- прошедшие вводный и первичный инструктаж на рабочем месте;
- прошедшие обучение безопасным методам и приемам выполнения работ;
- прошедшие стажировку на рабочем месте;
- прошедшие проверку знаний требований охраны труда.

1.2. Работник обязан:
- соблюдать требования охраны труда;
- правильно применять средства индивидуальной и коллективной защиты;
- проходить обучение безопасным методам и приемам выполнения работ;
- немедленно извещать своего руководителя о любой ситуации, угрожающей жизни и здоровью людей;
- проходить обязательные медицинские осмотры.

1.3. Работник имеет право:
- на рабочее место, соответствующее требованиям охраны труда;
- на обязательное социальное страхование от несчастных случаев;
- на получение достоверной информации об условиях и охране труда на рабочем месте;
- на отказ от выполнения работ в случае возникновения опасности для его жизни и здоровья.

1.4. Опасные и вредные производственные факторы:

{prompt}

Специфические факторы для данного вида работ:
- механические воздействия;
- повышенная запыленность и загазованность воздуха;
- повышенный уровень шума и вибрации;
- недостаточная освещенность рабочей зоны;
- физические перегрузки.

1.5. Работник должен быть обеспечен:
- специальной одеждой;
- специальной обувью;
- средствами индивидуальной защиты (СИЗ);
- смывающими и обезвреживающими средствами.

1.6. В процессе работы работник должен соблюдать:
- правила внутреннего трудового распорядка;
- режим труда и отдыха;
- правила пожарной безопасности;
- правила личной гигиены.

1.7. За невыполнение требований настоящей инструкции работник несет ответственность согласно действующему законодательству РФ.

## 2. ТРЕБОВАНИЯ ОХРАНЫ ТРУДА ПЕРЕД НАЧАЛОМ РАБОТЫ

2.1. Надеть спецодежду, спецобувь и другие средства индивидуальной защиты.

2.2. Получить задание на выполнение работы у непосредственного руководителя.

2.3. Проверить исправность и комплектность инструмента и оборудования:
- отсутствие повреждений корпуса, рукояток;
- надежность крепления деталей;
- исправность предохранительных устройств;
- наличие защитных кожухов и ограждений.

2.4. Осмотреть рабочее место и подходы к нему на предмет:
- отсутствия посторонних предметов;
- достаточности освещения;
- отсутствия скользких поверхностей;
- наличия ограждений опасных зон.

2.5. Подготовить необходимые материалы и разместить их в удобном и безопасном месте.

2.6. Проверить наличие и исправность:
- средств пожаротушения;
- аптечки первой помощи;
- средств связи.

2.7. Обо всех обнаруженных неисправностях оборудования, инвентаря, средств защиты сообщить непосредственному руководителю и не приступать к работе до их устранения.

## 3. ТРЕБОВАНИЯ ОХРАНЫ ТРУДА ВО ВРЕМЯ РАБОТЫ

3.1. Выполнять только ту работу, которая поручена непосредственным руководителем.

3.2. Соблюдать технологический процесс выполнения работы:

{prompt}

Основные правила безопасного выполнения работ:
- использовать инструмент строго по назначению;
- следить за исправностью инструмента в процессе работы;
- не допускать загромождения рабочего места;
- применять безопасные приемы выполнения операций;
- не отвлекаться на посторонние дела и разговоры.

3.3. Не допускается:
- работать неисправным инструментом;
- снимать или отключать предохранительные устройства;
- передавать управление оборудованием посторонним лицам;
- находиться на рабочем месте в состоянии алкогольного или наркотического опьянения;
- использовать неисправные средства защиты.

3.4. Содержать рабочее место в чистоте и порядке:
- убирать посторонние предметы;
- своевременно удалять отходы производства;
- не допускать скопления горючих материалов.

3.5. Не загромождать проходы и выходы материалами, заготовками, отходами.

3.6. При работе вблизи движущихся механизмов:
- соблюдать безопасное расстояние;
- не допускать попадания одежды в движущиеся части;
- следить за исправностью ограждений.

3.7. При переноске грузов вручную:
- соблюдать нормы предельно допустимых нагрузок;
- использовать средства малой механизации;
- применять правильные приемы подъема и перемещения.

3.8. Выполнять требования знаков безопасности, сигнальной разметки и предупредительных надписей.

3.9. В случае плохого самочувствия прекратить работу, поставить в известность непосредственного руководителя и обратиться к врачу.

## 4. ТРЕБОВАНИЯ ОХРАНЫ ТРУДА В АВАРИЙНЫХ СИТУАЦИЯХ

4.1. При возникновении аварийной ситуации:
- прекратить работу;
- отключить оборудование от источников энергии;
- сообщить непосредственному руководителю;
- покинуть опасную зону;
- действовать по указанию руководителя работ.

4.2. При обнаружении неисправности оборудования:
- немедленно прекратить работу;
- сообщить о неисправности руководителю;
- до устранения неисправности к работе не приступать.

4.3. При возникновении пожара:
- немедленно сообщить о пожаре по телефону 101 или 112;
- принять меры к эвакуации людей;
- приступить к тушению пожара имеющимися средствами пожаротушения;
- при угрозе жизни покинуть помещение.

4.4. При несчастном случае:
- немедленно прекратить работу;
- оказать первую помощь пострадавшему;
- вызвать скорую медицинскую помощь (телефон 103 или 112);
- сообщить о происшествии руководителю;
- сохранить обстановку на месте происшествия до прибытия комиссии.

4.5. Оказание первой помощи:
- вынести пострадавшего из опасной зоны;
- при кровотечении наложить жгут или давящую повязку;
- при переломах обеспечить неподвижность поврежденной части тела;
- при ожогах наложить стерильную повязку;
- при поражении электрическим током освободить от действия тока;
- придать пострадавшему удобное положение до прибытия медиков.

## 5. ТРЕБОВАНИЯ ОХРАНЫ ТРУДА ПО ОКОНЧАНИИ РАБОТЫ

5.1. Отключить оборудование от источников питания.

5.2. Привести в порядок рабочее место:
- убрать инструмент и приспособления в отведенные места;
- очистить оборудование от загрязнений;
- удалить отходы производства;
- протереть и смазать инструмент (при необходимости).

5.3. Снять спецодежду и средства индивидуальной защиты и убрать их в установленное место.

5.4. Вымыть руки и лицо теплой водой с мылом или принять душ.

5.5. Сообщить непосредственному руководителю:
- о всех неисправностях, замеченных во время работы;
- о недостатках, влияющих на безопасность труда;
- о выполненной работе.

---

**Инструкция разработана:** {category}  
**Дата разработки:** {get_current_date()}  
**Действует до:** пересмотра или отмены

**СОГЛАСОВАНО:**  
Специалист по охране труда _______________

**УТВЕРЖДАЮ:**  
Руководитель организации _______________

*Документ создан системой ГорТех Аттестация*
"""


def generate_job_instruction(title: str, category: str, prompt: str) -> str:
    """Генерирует должностную инструкцию"""
    return f"""# {title}

## Подразделение: {category}

---

## 1. ОБЩИЕ ПОЛОЖЕНИЯ

1.1. Настоящая должностная инструкция определяет функциональные обязанности, права и ответственность работника.

1.2. Работник назначается на должность и освобождается от должности приказом руководителя организации.

1.3. Работник подчиняется непосредственно [указать должность непосредственного руководителя].

1.4. На время отсутствия работника его обязанности исполняет лицо, назначенное приказом руководителя организации.

1.5. Квалификационные требования:

{prompt}

- Образование: высшее профессиональное / среднее профессиональное
- Опыт работы: не менее [указать стаж] лет
- Специальные знания: [перечислить требуемые знания]
- Специальные навыки: [перечислить требуемые навыки]

1.6. Работник должен знать:
- Законодательные и нормативные правовые акты, регламентирующие производственно-хозяйственную и финансово-экономическую деятельность организации
- Методические и нормативные материалы по организации труда
- Правила внутреннего трудового распорядка
- Правила и нормы охраны труда, техники безопасности, производственной санитарии и противопожарной защиты
- Порядок оформления документации

1.7. В своей деятельности работник руководствуется:
- Трудовым кодексом Российской Федерации
- Уставом организации
- Правилами внутреннего трудового распорядка
- Приказами и распоряжениями руководства
- Настоящей должностной инструкцией

## 2. ДОЛЖНОСТНЫЕ ОБЯЗАННОСТИ

2.1. Основные обязанности:

{prompt}

2.2. Работник обязан:
- Выполнять работу качественно и в установленные сроки
- Соблюдать требования охраны труда и пожарной безопасности
- Бережно относиться к имуществу организации
- Соблюдать правила внутреннего трудового распорядка
- Содержать рабочее место в чистоте и порядке
- Соблюдать установленный порядок хранения документов
- Не разглашать служебную информацию
- Повышать свою квалификацию

2.3. Планирование и организация работы:
- Планировать свою работу в соответствии с задачами подразделения
- Своевременно выполнять поручения руководства
- Соблюдать установленные сроки выполнения заданий
- Информировать руководителя о ходе выполнения работ

2.4. Документационное обеспечение:
- Оформлять документы в соответствии с установленными требованиями
- Вести учет и отчетность по направлению деятельности
- Обеспечивать сохранность документов
- Своевременно представлять отчетные материалы

2.5. Взаимодействие:
- Поддерживать рабочие отношения с коллегами
- Взаимодействовать с другими подразделениями организации
- Оперативно реагировать на запросы и обращения
- Участвовать в совещаниях и рабочих встречах

## 3. ПРАВА

3.1. Работник имеет право:

3.1.1. Знакомиться с проектами решений руководства организации, касающимися его деятельности.

3.1.2. Вносить предложения по совершенствованию работы, связанной с предусмотренными настоящей инструкцией обязанностями.

3.1.3. Запрашивать лично или по поручению непосредственного руководителя информацию и документы, необходимые для выполнения своих должностных обязанностей.

3.1.4. Требовать от руководства организации оказания содействия в исполнении своих должностных обязанностей и прав.

3.1.5. Повышать свою профессиональную квалификацию.

3.1.6. На рабочее место, соответствующее требованиям охраны труда.

3.1.7. На своевременную и в полном объеме выплату заработной платы.

3.1.8. На отдых, обеспечиваемый установлением нормальной продолжительности рабочего времени, предоставлением еженедельных выходных дней, нерабочих праздничных дней, оплачиваемых ежегодных отпусков.

3.1.9. На полную достоверную информацию об условиях труда и требованиях охраны труда на рабочем месте.

3.1.10. На защиту своих трудовых прав, свобод и законных интересов всеми не запрещенными законом способами.

## 4. ОТВЕТСТВЕННОСТЬ

4.1. Работник несет ответственность за:

4.1.1. Неисполнение или ненадлежащее исполнение своих должностных обязанностей, предусмотренных настоящей должностной инструкцией, - в пределах, определенных действующим трудовым законодательством РФ.

4.1.2. Причинение материального ущерба работодателю - в пределах, определенных действующим трудовым и гражданским законодательством РФ.

4.1.3. Правонарушения, совершенные в процессе осуществления своей деятельности, - в пределах, определенных действующим административным, уголовным и гражданским законодательством РФ.

4.1.4. Нарушение правил внутреннего трудового распорядка, правил противопожарной безопасности и техники безопасности.

4.1.5. Разглашение служебной и коммерческой информации.

4.1.6. Несоблюдение требований охраны труда.

4.2. Виды ответственности:
- Дисциплинарная ответственность в соответствии с ТК РФ
- Материальная ответственность в соответствии с ТК РФ
- Административная ответственность в соответствии с КоАП РФ
- Уголовная ответственность в соответствии с УК РФ

## 5. УСЛОВИЯ РАБОТЫ

5.1. Режим работы работника определяется в соответствии с Правилами внутреннего трудового распорядка, установленными в организации.

5.2. Продолжительность рабочего времени: 40 часов в неделю / в соответствии с графиком работы.

5.3. Ежегодный оплачиваемый отпуск: 28 календарных дней / [указать продолжительность].

5.4. Работнику устанавливается:
- Должностной оклад в размере [указать размер]
- Стимулирующие выплаты в соответствии с Положением об оплате труда
- Компенсационные выплаты в соответствии с законодательством

5.5. Работнику может быть установлен ненормированный рабочий день / разъездной характер работы [при необходимости].

## 6. ПОКАЗАТЕЛИ ЭФФЕКТИВНОСТИ

6.1. Оценка деятельности работника проводится по следующим критериям:
- Качество выполнения должностных обязанностей
- Своевременность выполнения заданий
- Соблюдение трудовой дисциплины
- Инициативность и ответственность
- Профессиональный рост

6.2. Периодичность оценки: ежегодно / по результатам аттестации.

---

**С инструкцией ознакомлен:**

_______________ / _______________  
(подпись) (расшифровка подписи)

Дата: {get_current_date()}

**СОГЛАСОВАНО:**  
Начальник отдела кадров _______________

**УТВЕРЖДАЮ:**  
Руководитель организации _______________

*Документ создан системой ГорТех Аттестация*
"""


def generate_profession_instruction(title: str, category: str, prompt: str) -> str:
    """Генерирует инструкцию по профессии"""
    return f"""# {title}

## Профессия: {category}

---

## 1. ОБЩИЕ СВЕДЕНИЯ О ПРОФЕССИИ

1.1. Область применения:

{prompt}

Данная профессиональная инструкция определяет требования к квалификации, знаниям, умениям и навыкам работников профессии "{category}".

1.2. Назначение профессии:
- Выполнение специализированных работ в соответствующей области
- Обеспечение качественного выполнения производственных задач
- Соблюдение технологических процессов и норм безопасности

1.3. Квалификационные разряды:
- 2-й разряд: выполнение простых работ под руководством
- 3-й разряд: выполнение работ средней сложности
- 4-й разряд: выполнение сложных работ
- 5-й разряд: выполнение особо сложных работ
- 6-й разряд: выполнение работ повышенной сложности

## 2. ТРЕБОВАНИЯ К КВАЛИФИКАЦИИ

2.1. Образование:
- Среднее профессиональное образование по профилю работы
- Дополнительное профессиональное образование (при необходимости)

2.2. Опыт работы:
- 2-й разряд: без требований к опыту
- 3-й разряд: не менее 1 года работы по профессии
- 4-й разряд: не менее 2 лет работы по профессии
- 5-й разряд: не менее 3 лет работы по профессии
- 6-й разряд: не менее 5 лет работы по профессии

2.3. Специальные требования:

{prompt}

- Медицинская комиссия: обязательный предварительный и периодические медосмотры
- Обучение по охране труда: первичное и периодическое (не реже 1 раза в 3 года)
- Проверка знаний: экзамен по профессии и охране труда

## 3. ДОЛЖЕН ЗНАТЬ

3.1. Общие знания:
- Устройство, принцип работы и правила эксплуатации оборудования
- Технологические процессы выполнения работ
- Свойства и характеристики применяемых материалов
- Способы проверки качества выполненных работ
- Правила чтения технической документации и чертежей

3.2. Специальные знания:

{prompt}

- Особенности технологического процесса в данной области
- Требования к качеству выполняемых работ
- Методы контроля и измерений
- Способы устранения дефектов и неисправностей

3.3. Охрана труда и безопасность:
- Требования охраны труда при выполнении работ
- Правила пожарной безопасности
- Правила электробезопасности
- Способы оказания первой помощи
- Порядок действий при аварийных ситуациях

## 4. ДОЛЖЕН УМЕТЬ

4.1. Основные умения:
- Выполнять работы в соответствии с технологическим процессом
- Пользоваться инструментом и оборудованием по назначению
- Читать техническую документацию и чертежи
- Проводить контроль качества выполненных работ
- Выявлять и устранять неисправности

4.2. Специальные умения:

{prompt}

- Выполнять операции, характерные для данной профессии
- Настраивать и регулировать оборудование
- Определять качество материалов и заготовок
- Рассчитывать параметры технологического процесса

4.3. Практические навыки:
- Безопасные приемы выполнения работ
- Правильное применение средств индивидуальной защиты
- Техническое обслуживание инструмента и оборудования
- Рациональная организация рабочего места

## 5. ВЫПОЛНЯЕМЫЕ РАБОТЫ

5.1. Основные виды работ:

{prompt}

Типовые операции:
- Подготовка материалов и оборудования к работе
- Выполнение основных технологических операций
- Контроль качества в процессе работы
- Устранение выявленных недостатков
- Оформление документации

5.2. Работы по разрядам:

**2-й разряд:**
- Выполнение простых подготовительных работ
- Работа под непосредственным руководством
- Использование простого инструмента

**3-й разряд:**
- Выполнение работ средней сложности
- Самостоятельная работа по заданию
- Использование механизированного инструмента

**4-й разряд:**
- Выполнение сложных работ
- Настройка и регулировка оборудования
- Контроль качества работ

**5-й разряд:**
- Выполнение особо сложных работ
- Руководство бригадой
- Обучение работников младших разрядов

**6-й разряд:**
- Выполнение уникальных работ
- Разработка технологических процессов
- Наставничество и обучение

## 6. ОРГАНИЗАЦИЯ РАБОЧЕГО МЕСТА

6.1. Требования к рабочему месту:
- Достаточная площадь и удобное расположение
- Хорошее освещение (естественное и искусственное)
- Вентиляция и нормальный микроклимат
- Наличие необходимого оборудования и инструмента
- Средства пожаротушения и аптечка

6.2. Оснащение рабочего места:
- Основное оборудование
- Вспомогательные приспособления и инструменты
- Измерительные приборы и инструменты
- Средства индивидуальной защиты
- Техническая документация

6.3. Порядок на рабочем месте:
- Инструмент и материалы должны быть размещены удобно и безопасно
- Проходы и выходы не должны загромождаться
- Отходы производства следует своевременно убирать
- По окончании работы рабочее место должно быть убрано

## 7. ОХРАНА ТРУДА И БЕЗОПАСНОСТЬ

7.1. Общие требования безопасности:
- Допуск к работе после прохождения инструктажей и обучения
- Использование исправного инструмента и оборудования
- Применение средств индивидуальной защиты
- Соблюдение технологического процесса

7.2. Требования безопасности перед работой:
- Осмотр рабочего места и оборудования
- Проверка исправности инструмента
- Подготовка средств индивидуальной защиты
- Получение задания у руководителя

7.3. Требования безопасности во время работы:

{prompt}

- Соблюдение безопасных приемов работы
- Использование инструмента по назначению
- Контроль состояния оборудования
- Своевременное информирование о неисправностях

7.4. Требования безопасности в аварийных ситуациях:
- Прекращение работы при возникновении опасности
- Сообщение руководителю об аварийной ситуации
- Действия по ликвидации последствий аварии
- Оказание первой помощи пострадавшим

7.5. Требования безопасности по окончании работы:
- Отключение оборудования
- Уборка рабочего места
- Сдача инструмента
- Доклад руководителю о выполненной работе

## 8. ОТВЕТСТВЕННОСТЬ

8.1. Работник несет ответственность за:
- Качественное и своевременное выполнение работ
- Соблюдение требований охраны труда
- Сохранность инструмента и оборудования
- Соблюдение трудовой дисциплины

8.2. Виды ответственности:
- Дисциплинарная (замечание, выговор, увольнение)
- Материальная (возмещение ущерба)
- Административная (штраф)
- Уголовная (за тяжкие нарушения)

## 9. ПОВЫШЕНИЕ КВАЛИФИКАЦИИ

9.1. Формы повышения квалификации:
- Курсы повышения квалификации (не реже 1 раза в 5 лет)
- Стажировка на производстве
- Самообразование
- Участие в семинарах и конференциях

9.2. Присвоение разряда:
- Обучение по программе профессиональной подготовки
- Сдача квалификационного экзамена
- Оформление протокола и удостоверения

---

**Инструкция разработана:** {category}  
**Дата:** {get_current_date()}  
**Срок действия:** до пересмотра

**СОГЛАСОВАНО:**  
Специалист по охране труда _______________

**УТВЕРЖДАЮ:**  
Руководитель организации _______________

*Документ создан системой ГорТех Аттестация*
"""


def generate_tool_instruction(title: str, category: str, prompt: str) -> str:
    """Генерирует инструкцию по работе с инструментом"""
    return f"""# {title}

## Тип инструмента: {category}

---

## 1. ОБЩИЕ ПОЛОЖЕНИЯ

1.1. Настоящая инструкция устанавливает требования безопасности при работе с инструментом.

1.2. Область применения:

{prompt}

Инструкция распространяется на все виды работ с использованием данного инструмента.

1.3. К работе с инструментом допускаются лица:
- прошедшие медицинский осмотр
- прошедшие обучение безопасным методам работы
- прошедшие инструктаж на рабочем месте
- имеющие соответствующую квалификацию

1.4. Опасные факторы при работе с инструментом:
- механические травмы (порезы, ушибы, проколы)
- попадание частиц материала в глаза
- шум и вибрация
- физическая перегрузка
- поражение электрическим током (для электроинструмента)

## 2. ХАРАКТЕРИСТИКИ ИНСТРУМЕНТА

2.1. Назначение инструмента:

{prompt}

Инструмент предназначен для выполнения следующих операций:
- [указать основные операции]
- [указать дополнительные операции]

2.2. Технические характеристики:
- Тип: [ручной / механизированный / электрический]
- Основные параметры: [указать размеры, мощность и т.д.]
- Рабочие режимы: [описать режимы работы]
- Комплектация: [перечислить составные части]

2.3. Устройство инструмента:
- Рабочая часть: [описание]
- Рукоятка: [описание]
- Защитные элементы: [описание]
- Дополнительные элементы: [описание]

## 3. ПОДГОТОВКА К РАБОТЕ

3.1. Перед началом работы проверить:

**Исправность инструмента:**
- отсутствие трещин, сколов, деформаций
- надежность крепления всех деталей
- состояние рабочей части (острота, износ)
- исправность рукояток и накладок
- наличие и исправность защитных устройств

**Комплектность:**
- наличие всех необходимых частей
- наличие сменных элементов
- наличие регулировочных ключей
- наличие защитных приспособлений

3.2. Подготовка инструмента к работе:

{prompt}

Порядок подготовки:
1. Осмотреть инструмент на предмет повреждений
2. Проверить крепление всех элементов
3. При необходимости заменить изношенные части
4. Настроить инструмент для выполнения работы
5. Проверить работу на холостом ходу

3.3. Средства индивидуальной защиты:
- Защитные очки или щиток
- Защитные перчатки
- Спецодежда и спецобувь
- Средства защиты органов дыхания (при необходимости)
- Средства защиты слуха (при повышенном шуме)

3.4. Организация рабочего места:
- Обеспечить достаточное освещение
- Подготовить удобную рабочую поверхность
- Убрать посторонние предметы
- Расположить материалы в зоне досягаемости
- Проверить устойчивость заготовки

## 4. ПОРЯДОК ВЫПОЛНЕНИЯ РАБОТЫ

4.1. Общие правила работы:

{prompt}

Основные требования:
- Использовать инструмент только по назначению
- Соблюдать правильные приемы работы
- Контролировать состояние инструмента в процессе работы
- Не превышать допустимые нагрузки
- Делать перерывы для отдыха

4.2. Правильная хватка и положение:
- Держать инструмент прочно и уверенно
- Принять устойчивое положение тела
- Обеспечить хороший обзор рабочей зоны
- Не работать в неудобном положении
- Не прилагать чрезмерных усилий

4.3. Выполнение рабочих операций:

**Подготовительные операции:**
- Разметка заготовки
- Закрепление материала
- Настройка инструмента

**Основные операции:**
{prompt}

- Выполнение работы плавными движениями
- Контроль направления и усилия
- Своевременная очистка инструмента
- Проверка качества работы

**Заключительные операции:**
- Завершение обработки
- Снятие заготовки
- Очистка инструмента

4.4. Техника безопасности при работе:
- Не отвлекаться во время работы
- Следить за положением рук и пальцев
- Не держать заготовку на весу
- Не работать тупым или поврежденным инструментом
- Не передавать инструмент броском

4.5. Запрещается:
- Работать неисправным инструментом
- Использовать инструмент не по назначению
- Снимать защитные устройства
- Работать без средств защиты
- Оставлять инструмент без присмотра в рабочем состоянии

## 5. ТЕХНИЧЕСКОЕ ОБСЛУЖИВАНИЕ

5.1. Ежедневное обслуживание:
- Очистка от загрязнений после работы
- Проверка состояния рабочих частей
- Удаление стружки и пыли
- Визуальный осмотр на предмет повреждений
- Протирка и просушка

5.2. Периодическое обслуживание:

{prompt}

- Смазка подвижных частей
- Заточка режущих кромок
- Замена изношенных деталей
- Регулировка механизмов
- Проверка исправности защитных устройств

5.3. Заточка инструмента:
- Проводится при снижении остроты
- Выполняется специально обученным персоналом
- Соблюдается правильный угол заточки
- После заточки проверяется качество
- Затупленный инструмент изымается из работы

5.4. Хранение инструмента:
- В специально отведенном месте
- В чистом и сухом виде
- Защищенным от механических повреждений
- Отдельно от других инструментов
- В чехлах или ящиках

## 6. ДЕЙСТВИЯ В АВАРИЙНЫХ СИТУАЦИЯХ

6.1. При поломке инструмента:
- Немедленно прекратить работу
- Убрать инструмент из рабочей зоны
- Сообщить руководителю о поломке
- Не пытаться ремонтировать самостоятельно
- Сдать инструмент на ремонт

6.2. При получении травмы:
- Прекратить работу
- Оказать первую помощь пострадавшему
- Вызвать медицинскую помощь (при необходимости)
- Сообщить руководителю о происшествии
- Сохранить обстановку до расследования

6.3. Первая помощь при травмах:

**При порезах:**
- Промыть рану чистой водой
- Обработать антисептиком
- Наложить стерильную повязку
- При сильном кровотечении наложить жгут

**При ушибах:**
- Приложить холод к месту ушиба
- Обеспечить покой поврежденной части
- При сильной боли обратиться к врачу

**При попадании инородных тел в глаза:**
- Не тереть глаз
- Промыть глаз чистой водой
- Закапать антисептические капли
- Обратиться к врачу

## 7. ОТВЕТСТВЕННОСТЬ

7.1. Работник несет ответственность за:
- Правильное использование инструмента
- Соблюдение требований безопасности
- Своевременное техническое обслуживание
- Сохранность инструмента
- Информирование о неисправностях

7.2. При нарушении требований инструкции:
- Дисциплинарное взыскание
- Отстранение от работы
- Материальная ответственность за ущерб
- Административная или уголовная ответственность (при тяжких последствиях)

---

**Инструкция разработана:** {category}  
**Дата разработки:** {get_current_date()}  
**Срок действия:** до пересмотра

**СОГЛАСОВАНО:**  
Специалист по охране труда _______________

**УТВЕРЖДАЮ:**  
Руководитель организации _______________

*Документ создан системой ГорТех Аттестация*
"""


def generate_electro_instruction(title: str, category: str, prompt: str) -> str:
    """Генерирует инструкцию по электроинструменту"""
    return f"""# {title}

## Электроинструмент: {category}

---

## 1. ОБЩИЕ ТРЕБОВАНИЯ БЕЗОПАСНОСТИ

1.1. Настоящая инструкция устанавливает требования безопасности при работе с электроинструментом.

1.2. Область применения:

{prompt}

Инструкция обязательна для исполнения всеми работниками, использующими электроинструмент.

1.3. К работе с электроинструментом допускаются лица:
- достигшие 18 лет
- прошедшие обязательный медицинский осмотр
- прошедшие обучение по электробезопасности (группа не ниже II)
- прошедшие обучение безопасным методам работы с электроинструментом
- прошедшие инструктаж на рабочем месте
- прошедшие проверку знаний

1.4. Опасные производственные факторы:
- поражение электрическим током
- механические травмы вращающимися частями
- вылет обрабатываемого материала или инструмента
- повышенный уровень шума и вибрации
- повышенная запыленность воздуха
- повышенная температура поверхностей оборудования

1.5. Средства индивидуальной защиты:
- защитные очки или щиток
- защитные перчатки диэлектрические
- спецодежда из хлопчатобумажной ткани
- обувь на резиновой подошве
- средства защиты органов слуха (при уровне шума выше 80 дБ)
- средства защиты органов дыхания (при пыльных работах)

## 2. ТЕХНИЧЕСКИЕ ХАРАКТЕРИСТИКИ

2.1. Назначение электроинструмента:

{prompt}

Электроинструмент предназначен для:
- [указать основные виды операций]
- [указать материалы обработки]

2.2. Основные параметры:
- Напряжение питания: 220 В / 380 В / аккумулятор
- Потребляемая мощность: [указать мощность] Вт
- Частота вращения: [указать обороты] об/мин
- Класс защиты: [I / II / III класс]
- Степень защиты: [IP20 / IP54 и т.д.]

2.3. Конструктивные элементы:
- Электродвигатель
- Рабочий орган (диск, сверло, фреза и т.д.)
- Редуктор (при наличии)
- Защитный кожух
- Рукоятки с изоляцией
- Кнопка пуска с блокировкой
- Электрический кабель с вилкой

## 3. ТРЕБОВАНИЯ ЭЛЕКТРОБЕЗОПАСНОСТИ

3.1. Перед началом работы проверить:

**Электрическую часть:**
- целостность изоляции проводов и кабеля
- исправность вилки и розетки
- отсутствие оголенных токоведущих частей
- исправность заземляющего контакта
- работу кнопки пуска и блокировки

**Механическую часть:**
- надежность крепления рабочего органа
- отсутствие люфтов и биений
- исправность защитного кожуха
- состояние рукояток
- отсутствие трещин в корпусе

3.2. Требования к электропитанию:
- Напряжение сети должно соответствовать паспортным данным
- Использовать только исправные розетки с заземлением
- Не допускается работа при отсутствии заземления
- Подключать только через устройство защитного отключения (УЗО)
- Не использовать самодельные удлинители

3.3. Запрещается:
- работать с электроинструментом класса I без заземления
- работать с поврежденной изоляцией
- самостоятельно ремонтировать электрическую часть
- оставлять инструмент подключенным к сети без присмотра
- передавать электроинструмент лицам, не имеющим допуска
- работать в условиях повышенной влажности без специальной защиты

3.4. Группы электробезопасности:
- II группа: для ручного электроинструмента до 1000 В
- III группа: для стационарного электрооборудования
- Присвоение группы: после обучения и проверки знаний
- Периодичность проверки: не реже 1 раза в год

## 4. ПОДГОТОВКА К РАБОТЕ

4.1. Внешний осмотр электроинструмента:

{prompt}

- Проверить целостность корпуса
- Убедиться в исправности кабеля
- Проверить крепление рабочего органа
- Осмотреть защитные устройства
- Проверить состояние рукояток

4.2. Установка рабочего органа:
- Отключить инструмент от сети
- Установить необходимый рабочий орган (диск, сверло, насадку)
- Надежно закрепить крепежными элементами
- Проверить отсутствие биения
- Установить защитный кожух в правильное положение

4.3. Подключение к электросети:
- Подключить к розетке с заземлением
- Проверить работу на холостом ходу
- Убедиться в отсутствии посторонних шумов и вибрации
- Проверить работу кнопки пуска и блокировки
- При обнаружении неисправностей немедленно отключить

4.4. Подготовка рабочего места:
- Обеспечить хорошее освещение
- Убрать посторонние предметы
- Закрепить обрабатываемую деталь
- Обеспечить устойчивое положение
- Проверить отсутствие горючих материалов вблизи

## 5. ПОРЯДОК РАБОТЫ

5.1. Включение электроинструмента:
- Принять устойчивое положение
- Крепко взяться за рукоятки обеими руками
- Убедиться, что рабочий орган не касается детали
- Нажать кнопку пуска
- Дождаться выхода на рабочие обороты
- Плавно подвести к обрабатываемой детали

5.2. Выполнение работы:

{prompt}

Основные правила:
- Крепко удерживать инструмент двумя руками
- Не допускать перегрузки двигателя
- Делать перерывы для охлаждения (при длительной работе)
- Следить за состоянием рабочего органа
- Контролировать целостность кабеля

5.3. Безопасные приемы работы:
- Подавать инструмент на деталь плавно, без рывков
- Не прилагать чрезмерных усилий
- При заклинивании немедленно отключить инструмент
- Не тормозить рабочий орган руками после отключения
- Дождаться полной остановки перед установкой инструмента

5.4. Работа в различных условиях:

**В помещении:**
- Обеспечить проветривание при выделении пыли
- Не работать вблизи легковоспламеняющихся материалов
- Не работать стоя на токопроводящем основании

**На открытом воздухе:**
- Не работать под дождем или снегом
- Защитить от попадания влаги
- При работе с переносными подмостями обеспечить устойчивость

**Во взрывоопасных помещениях:**
- Использовать только специальный искробезопасный инструмент
- Соблюдать дополнительные требования безопасности

5.5. Запрещается:
- Работать одной рукой (за исключением специального инструмента)
- Удерживать обрабатываемую деталь руками
- Работать в непосредственной близости от легковоспламеняющихся материалов
- Оставлять работающий инструмент без присмотра
- Передавать работающий инструмент другому лицу
- Касаться вращающихся частей
- Работать в состоянии утомления

## 6. ТЕХНИЧЕСКОЕ ОБСЛУЖИВАНИЕ

6.1. Ежедневное обслуживание:
- Очистка от пыли и загрязнений
- Проверка состояния кабеля и вилки
- Проверка крепления рабочих органов
- Смазка редуктора (при необходимости)
- Проверка работы на холостом ходу

6.2. Периодическое обслуживание:

{prompt}

- Замена изношенных щеток двигателя
- Смазка подшипников
- Проверка состояния обмоток двигателя
- Замена изношенных рабочих органов
- Проверка изоляции мегомметром

6.3. Хранение электроинструмента:
- В сухом помещении при температуре от +5°C до +40°C
- В заводской упаковке или специальном ящике
- С отсоединенным кабелем питания
- Со снятыми рабочими органами
- Защищенным от механических повреждений

6.4. Ремонт электроинструмента:
- Выполняется только специализированным персоналом
- В специально оборудованной мастерской
- С использованием оригинальных запчастей
- С последующей проверкой изоляции
- С записью в журнале учета

## 7. ДЕЙСТВИЯ В АВАРИЙНЫХ СИТУАЦИЯХ

7.1. При поражении электрическим током:
- Немедленно отключить электроинструмент от сети
- Освободить пострадавшего от действия тока
- Вызвать скорую медицинскую помощь (103 или 112)
- Приступить к оказанию первой помощи
- Сообщить руководителю о происшествии

7.2. При возгорании электроинструмента:
- Отключить от электросети
- Приступить к тушению углекислотным или порошковым огнетушителем
- Не применять воду для тушения
- Эвакуировать людей из опасной зоны
- Вызвать пожарную охрану (101 или 112)

7.3. При механической травме:
- Отключить электроинструмент
- Оказать первую помощь пострадавшему
- При необходимости вызвать скорую помощь
- Сообщить руководителю
- Сохранить обстановку для расследования

7.4. При неисправности электроинструмента:
- Немедленно отключить от сети
- Сообщить руководителю о неисправности
- Вывесить табличку "Не включать! Работают люди!"
- Сдать инструмент на ремонт или экспертизу
- К работе не приступать до устранения неисправности

## 8. ОКОНЧАНИЕ РАБОТЫ

8.1. Порядок отключения:
- Отвести инструмент от обрабатываемой детали
- Отпустить кнопку пуска
- Дождаться полной остановки рабочего органа
- Отключить от электросети
- Положить инструмент в безопасное место

8.2. Уборка рабочего места:
- Убрать обрабатываемые детали и заготовки
- Очистить инструмент от стружки и пыли
- Смотать кабель
- Снять рабочий орган (при необходимости)
- Убрать инструмент на место хранения

8.3. Сообщить руководителю:
- О выполненной работе
- Обо всех неисправностях, обнаруженных во время работы
- О всех случаях нарушения работы инструмента

---

**Инструкция разработана:** {category}  
**Дата разработки:** {get_current_date()}  
**Срок действия:** до пересмотра или отмены

**СОГЛАСОВАНО:**  
Специалист по охране труда _______________  
Энергетик _______________

**УТВЕРЖДАЮ:**  
Руководитель организации _______________

*Документ создан системой ГорТех Аттестация*
"""


def generate_generic_document(title: str, category: str, prompt: str) -> str:
    """Генерирует общий документ"""
    return f"""# {title}

## {category}

{prompt}

---

Этот документ был автоматически сгенерирован системой ГорТех Аттестация.

Дата создания: {get_current_date()}
"""


def get_current_date() -> str:
    """Возвращает текущую дату в формате ДД.ММ.ГГГГ"""
    from datetime import datetime
    return datetime.now().strftime('%d.%m.%Y')
